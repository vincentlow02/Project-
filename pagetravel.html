<!DOCTYPE html>

<html lang="ja">

<head>

  <meta charset="UTF-8">

  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="pagetravel.css">
  <title>&#26908;&#32034;&#32080;&#26524; | Weave Travel</title>

  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-S0W2VWDR00"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-S0W2VWDR00');
  </script>

</head>

<body class="search-results-page">
  <section class="page" id="searchInterface">

    <!-- Sidebar -->
    <div id="sidebar" class="collapsed">

      <!-- Sidebar Icon Bar -->
      <div class="sidebar-icon-bar">
        <div class="sidebar-item" id="sidebar-toggle">
          <div class="icon">
            <img src="assets/arrow-left.svg" alt="Toggle Sidebar">
          </div>
        </div>

        <div class="sidebar-nav">
          <div class="sidebar-item">
            <div class="icon">
              <img src="assets/plus.svg" alt="New">
            </div>
          </div>

          <div class="sidebar-item active">
            <div class="icon">
              <img src="assets/search-icon.svg" alt="Home">
            </div>
            <span class="sidebar-label">ホーム</span>
          </div>

          <div class="sidebar-item">
            <div class="icon">
              <img src="assets/star.svg" alt="Saved">
            </div>
            <span class="sidebar-label">保存</span>
          </div>

          <div class="sidebar-item">
            <div class="icon">
              <img src="assets/discover.svg" alt="Discover">
            </div>
            <span class="sidebar-label">発見</span>
          </div>
        </div>
      </div>

      <!-- Sidebar Content Panel -->
      <div class="sidebar-content-panel">
        <div class="panel-header">
          <span class="panel-title">ホーム</span>
          <img src="assets/pin.svg" alt="Pin">
        </div>

        <div class="panel-section">
          <h3 class="subheader">チャット</h3>
          <ul class="chat-list">
            <li>海外旅行おすすめ</li>
          </ul>
        </div>
      </div>
    </div>

    <main id="page-content">
      <img src="assets/Rectangle205.svg"
           style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover; z-index: 0;">

      <div class="hokkaido-logo-container">
        <img src="assets/Hokkaidologo.svg" alt="Hokkaido Logo" class="hokkaido-logo">
        <img src="assets/ques.svg" alt="Question Icon" class="ques-icon">

        <div class="hokkaido-video-container"
             data-custom-fullscreen
             data-sidebar-title="Otaru"
             data-sidebar-subtitle="北海道冬の魅力：札幌＆小樽"
             data-sidebar-description="小樽は、北海道を代表する港町で、レトロな運河や石造りの倉庫群が魅力です。冬には雪に包まれた街並みがロマンチックな雰囲気を醸し出し、夜には大都市にも負けないイルミネーションとグルメが楽しめます。"


          <!-- Vimeo iframe sits beneath the decorative frame -->
          <div class="vimeo-wrapper">
            <iframe class="vimeo-iframe"
                    src="https://player.vimeo.com/video/1133040806?share=copy&fl=sv&fe=ci&autoplay=0&muted=0&controls=1&title=0&byline=0&portrait=0"
                    allow="autoplay; fullscreen; picture-in-picture"
                    allowfullscreen
                    title="Hokkaido Experience"></iframe>
          </div>

          <!-- Click overlay keeps native controls accessible (adjust bottom gap as needed) -->
          <div class="vimeo-toggle-hitbox" aria-hidden="true"></div>

          <!-- Decorative SVG frame stays visible on top -->
          <img src="assets/hkdvideo.svg" alt="Video Frame" class="hokkaido-video-frame">
          <img src="assets/Rectanglecomment.svg" alt="Comment Rectangle" class="rectangle-comment">

          <div id="hokkaido-subtitles" class="subtitle-container"></div>
        </div>
      </div>

      <section class="finland-section">
        <img src="assets/Finland.svg" alt="Finland" class="finland-logo">
        <div class="finland-video-container">
          <img src="assets/finlandvideo.svg" alt="Finland Video Frame" class="finland-video-frame">
          <div class="finland-video-wrapper">
            <iframe class="finland-vimeo-iframe"
                    src="https://player.vimeo.com/video/1133091141?autoplay=0&muted=0&controls=1&title=0&byline=0&portrait=0&fullscreen=0"
                    allow="autoplay; picture-in-picture"
                    title="Finland Experience"></iframe>
          </div>
        </div>
      </section>
    </main>
  </section>

  <div id="custom-fullscreen-overlay" class="custom-fullscreen-overlay" aria-hidden="true">
    <div class="custom-fullscreen-wrapper">
      <div class="custom-fullscreen-video-area">
        <div class="custom-fullscreen-video-viewport"></div>
      </div>

      <aside class="custom-fullscreen-sidebar">
        <button type="button" class="custom-fullscreen-close" aria-label="Close fullscreen">
          <img src="assets/close.svg" alt="">
        </button>
        <div class="custom-fullscreen-sidebar-content"></div>
      </aside>
    </div>
  </div>
</body>




  <script src="https://player.vimeo.com/api/player.js"></script>

<script>
 // ------------------ 滚屏控制 ------------------
window.addEventListener('scroll', () => {
  const scrollX = window.scrollX || document.documentElement.scrollLeft;
  const sidebar = document.getElementById('sidebar');
  if (sidebar) sidebar.style.left = `${scrollX}px`;
  const quesIcon = document.querySelector('.ques-icon');
  if (quesIcon) {
    const baseLeft = -670;
    quesIcon.style.left = `${scrollX + baseLeft}px`;
  }
});

// ------------------ 唯一的 DOMContentLoaded 监听器 (已合并所有代码) ------------------
document.addEventListener('DOMContentLoaded', () => {
    
  // --- 1. 侧边栏和搜索逻辑 (来自你原来的代码) ---
  const searchInput = document.querySelector('.search-bar input');
  const searchQueryLabel = document.getElementById('search-query');
  const resultsGrid = document.getElementById('resultsGrid');
  const resultsEmpty = document.getElementById('resultsEmpty');
  const sidebarToggle = document.getElementById('sidebar-toggle');
  const sidebar = document.getElementById('sidebar');
  const pageContent = document.getElementById('page-content');

  // (你原来的 sampleResults, normalize, filterResults, renderResults 函数...)
  // (为了简洁，这里省略了它们的定义，但你的代码中应该保留它们)

  const params = new URLSearchParams(window.location.search);
  const query = params.get('q')?.trim() || '';

  if (searchQueryLabel) {
    searchQueryLabel.textContent = query || 'おすすめ';
  }
  if (searchInput) {
    // (你原来的 searchInput 事件监听器)
  }
  if (sidebar && sidebarToggle && pageContent) {
    sidebarToggle.addEventListener('click', () => {
      sidebar.classList.toggle('collapsed');
      pageContent.classList.toggle('sidebar-collapsed');
    });
  }
  // renderResults(filterResults(query)); // 你可能需要在这里调用


const subtitleContainer = document.getElementById('hokkaido-subtitles');
  if (!subtitleContainer) {
    console.warn("字幕：未找到 'hokkaido-subtitles' 容器。");
  }

  const subtitleConfigs = [
    { title: '北海道冬の魅力：札幌＆小樽', description: '小樽は、北海道を代表する港町で、レトロな運河や石造りの倉庫群が魅力です。冬には雪に包まれた街並みがロマンチックな雰囲気を醸し出し、夜には大都市にも負けないイルミネーションとグルメが楽しめます。', titleSpeed: 28, descSpeed: 34 },
    { title: '船見坂', description: '映画『Love Letter』のロケ地。坂の上から港と街並みを一望できる。', titleSpeed: 28, descSpeed: 40 },
    { title: 'すすきの交差点', description: '札幌最大の繁華街すすきの。NIKKAのネオンが輝き、飲食店やショップが並ぶにぎやかな夜の街。', titleSpeed: 28, descSpeed: 30 },
    { title: '藻岩山の夜景', description: '藻岩山は「日本新三大夜景」の一つ。ロープウェイで登ると、札幌の街が宝石のように輝く絶景を望めます。', titleSpeed: 30, descSpeed: 41 },
    { title: '白い恋人ソフトクリーム', description: '北海道を代表するお土産。', titleSpeed: 28, descSpeed: 24 },
    { title: 'うな重', description: 'うな重は全国で親しまれる日本料理の一つ。', titleSpeed: 42, descSpeed: 70 },
    { title: 'ジンギスカン', description: '北海道名物のジンギスカン。ラム肉と野菜を特製鍋で焼き、タレと相性抜群の一品。', titleSpeed: 40, descSpeed: 50 },
    { title: '元祖さっぽろラーメン横丁', description: '札幌は味噌ラーメン発祥の地。ラーメン横丁には昭和の雰囲気の老舗が並び、熱々の一杯が楽しめます。', titleSpeed: 30, descSpeed: 30 },
    { title: '大通公園＆さっぽろテレビ塔', description: '札幌中心の大通公園は市民の憩いの場。冬はホワイトイルミネーションや雪まつりで街が彩られます。', titleSpeed: 37, descSpeed: 30 },
  ];

  const WAIT_AFTER_GROUP = 1000;

  class SubtitleController {
    constructor(configs, container) {
      this.configs = configs;
      this.container = container;
      this.started = false;
      this.paused = false;
      this.currentGroup = 0;
      this.stage = 'idle';
      this.titleIndex = 0;
      this.descIndex = 0;
      this.currentTimeout = null;
      this.waitRemaining = WAIT_AFTER_GROUP;
      this.waitStart = null;
    }
    clearCurrentTimeout() {
      if (this.currentTimeout !== null) {
        clearTimeout(this.currentTimeout);
        this.currentTimeout = null;
      }
    }
    prepareCurrentGroup() {
      const group = this.configs[this.currentGroup];
      if (!group || !this.container) return;
      this.container.innerHTML = '';
      const titleLine = document.createElement('div');
      titleLine.className = 'subtitle-line subtitle-title';
      const titleText = document.createElement('span');
      titleText.className = 'subtitle-text';
      const titleCursor = document.createElement('span');
      titleCursor.className = 'subtitle-cursor';
      titleCursor.textContent = '|';
      titleLine.append(titleText, titleCursor);
      const descLine = document.createElement('div');
      descLine.className = 'subtitle-line subtitle-description';
      const descText = document.createElement('span');
      descText.className = 'subtitle-text';
      const descCursor = document.createElement('span');
      descCursor.className = 'subtitle-cursor';
      descCursor.textContent = '|';
      descLine.append(descText, descCursor);
      this.container.append(titleLine, descLine);
      this.titleLine = titleLine;
      this.titleText = titleText;
      this.descLine = descLine;
      this.descText = descText;
      this.titleLine.classList.remove('is-complete', 'is-typing');
      this.descLine.classList.remove('is-complete', 'is-typing');
      this.titleText.textContent = '';
      this.descText.textContent = '';
    }
    start() {
      if (!this.configs.length) return;
      this.started = true;
      this.paused = false;
      this.currentGroup = 0;
      this.stage = 'title';
      this.titleIndex = 0;
      this.descIndex = 0;
      this.waitRemaining = WAIT_AFTER_GROUP;
      this.prepareCurrentGroup();
      this.scheduleNextStep();
    }
    pause() {
      if (!this.started || this.paused) return;
      this.paused = true;
      if (this.stage === 'wait' && this.waitStart) {
        const elapsed = Date.now() - this.waitStart;
        this.waitRemaining = Math.max(0, this.waitRemaining - elapsed);
      }
      this.clearCurrentTimeout();
    }
    resume() {
      if (!this.started || !this.paused) return;
      this.paused = false;
      if (this.stage === 'wait') {
        if (this.waitRemaining <= 0) {
          this.advanceGroup();
        } else {
          this.waitStart = Date.now();
          this.currentTimeout = setTimeout(() => this.advanceGroup(), this.waitRemaining);
        }
        return;
      }
      this.scheduleNextStep();
    }
    reset() {
      this.clearCurrentTimeout();
      this.started = false;
      this.paused = false;
      this.currentGroup = 0;
      this.stage = 'idle';
      this.titleIndex = 0;
      this.descIndex = 0;
      this.waitRemaining = WAIT_AFTER_GROUP;
      this.waitStart = null;
      if (this.container) this.container.innerHTML = '';
    }
    scheduleNextStep() {
      if (!this.started || this.paused) return;
      const group = this.configs[this.currentGroup];
      if (!group) return;
      if (this.stage === 'title') {
        this.titleLine.classList.add('is-typing');
        if (this.titleIndex < group.title.length) {
          this.titleText.textContent += group.title[this.titleIndex++];
          this.currentTimeout = setTimeout(() => this.scheduleNextStep(), group.titleSpeed);
        } else {
          this.titleLine.classList.replace('is-typing', 'is-complete');
          this.stage = 'description';
          this.scheduleNextStep();
        }
        return;
      }
      if (this.stage === 'description') {
        this.descLine.classList.add('is-typing');
        if (this.descIndex < group.description.length) {
          this.descText.textContent += group.description[this.descIndex++];
          this.currentTimeout = setTimeout(() => this.scheduleNextStep(), group.descSpeed);
        } else {
          this.descLine.classList.replace('is-typing', 'is-complete');
          this.stage = 'wait';
          this.waitRemaining = WAIT_AFTER_GROUP;
          this.waitStart = Date.now();
          this.currentTimeout = setTimeout(() => this.advanceGroup(), this.waitRemaining);
        }
      }
    }
    advanceGroup() {
      this.clearCurrentTimeout();
      if (!this.started || this.paused) return;
      this.currentGroup = (this.currentGroup + 1) % this.configs.length;
      this.stage = 'title';
      this.titleIndex = 0;
      this.descIndex = 0;
      this.waitRemaining = WAIT_AFTER_GROUP;
      this.waitStart = null;
      this.prepareCurrentGroup();
      this.scheduleNextStep();
    }
  }
  const subtitleController = new SubtitleController(subtitleConfigs, subtitleContainer);

  // 辅助函数：为 *一个* player 实例绑定字幕事件
  function initializeSubtitleEvents(player) {
    if (!player) return;
    player.on('play', () => {
      player.getCurrentTime().then((seconds) => {
        if (seconds <= 0.1) {
          subtitleController.reset();
          subtitleController.start();
          return;
        }

        if (!subtitleController.started) {
          subtitleController.start();
        } else {
          subtitleController.resume();
        }
      }).catch(() => {
        if (!subtitleController.started) subtitleController.start(); else subtitleController.resume();
      });
    });
    player.on('pause', () => subtitleController.pause());
    player.on('ended', () => subtitleController.reset());
    player.on('seeked', ({ seconds }) => {
      if (seconds <= 0.1) { player.getPaused().then((paused) => { if (paused) subtitleController.reset(); }); }
    });
  }


  /* --- 3. 自定义全屏逻辑 (已完全修复) --- */
  const overlay = document.getElementById('custom-fullscreen-overlay');
  if (!overlay || typeof Vimeo === 'undefined' || !Vimeo.Player) {
    console.warn("自定义全屏：未找到必要元素或 Vimeo API。");
    return;
  }

  const htmlEl = document.documentElement;
  const bodyEl = document.body;
  const wrapper = overlay.querySelector('.custom-fullscreen-wrapper');
  const videoViewport = overlay.querySelector('.custom-fullscreen-video-viewport');
  const sidebarContent = overlay.querySelector('.custom-fullscreen-sidebar-content');
  const closeButton = overlay.querySelector('.custom-fullscreen-close');

  if (!videoViewport || !sidebarContent) {
    console.warn("自定义全屏：未找到 videoViewport 或 sidebarContent。");
    return;
  }

  // [核心] WeakMap 用于存储每个视频容器的 player 实例和状态
  const fullscreenContexts = new WeakMap();
  let activeContext = null;

  function populateSidebar(data) {
    sidebarContent.innerHTML = '';
    if (!data) {
      return false;
    }

    let hasContent = false;

    if (data.title) {
      const titleEl = document.createElement('h2');
      titleEl.textContent = data.title;
      sidebarContent.appendChild(titleEl);
      hasContent = true;
    }
    if (data.subtitle) {
      const subtitleEl = document.createElement('h3');
      subtitleEl.textContent = data.subtitle;
      sidebarContent.appendChild(subtitleEl);
      hasContent = true;
    }
    if (data.description) {
      const descEl = document.createElement('p');
      descEl.textContent = data.description;
      sidebarContent.appendChild(descEl);
      hasContent = true;
    }
    if (data.list && data.list.length) {
      const listEl = document.createElement('ul');
      data.list.forEach((item) => {
        const li = document.createElement('li');
        li.textContent = item;
        listEl.appendChild(li);
      });
      sidebarContent.appendChild(listEl);
      hasContent = true;
    }

    return hasContent;
  }

  function getSidebarData(container) {
    return {
      title: container.getAttribute('data-sidebar-title') || '',
      subtitle: container.getAttribute('data-sidebar-subtitle') || '',
      description: container.getAttribute('data-sidebar-description') || '',
      list: (container.getAttribute('data-sidebar-list') || '')
        .split('|')
        .map((item) => item.trim())
        .filter(Boolean),
    };
  }

  function restoreSidebarDataset(container, data = {}) {
    const context = container ? fullscreenContexts.get(container) : null;
    if (!context) {
      return;
    }

    context.sidebarData = {
      title: data.title || '',
      subtitle: data.subtitle || '',
      description: data.description || '',
      list: Array.isArray(data.list) ? [...data.list] : [],
    };
  }

  // 3a. 确保 Context 存在，并创建/存储 *唯一* 的 player 实例
  function ensureContext(container) {
    let context = fullscreenContexts.get(container);
    if (!context) {
      const iframe = container.querySelector('iframe');
      context = {
        container,
        originalParent: container.parentNode,
        placeholder: null,
        player: iframe ? new Vimeo.Player(iframe) : null,
        originalSrc: iframe ? iframe.src : '',
        sidebarData: {}
      };
      if (context.player) {
         console.log("Vimeo: 唯一的播放器已创建。");
      }
      fullscreenContexts.set(container, context);
    } else if (!context.originalParent || !context.originalParent.isConnected) {
      context.originalParent = container.parentNode;
    }

    const freshData = getSidebarData(container);
    if (
      freshData.title ||
      freshData.subtitle ||
      freshData.description ||
      (freshData.list && freshData.list.length)
    ) {
      context.sidebarData = freshData;
    } else {
      context.sidebarData = {};
    }

    return context;
  }

  function ensurePlaceholder(context) {
    const { container } = context;
    if (!context.originalParent) {
      context.originalParent = container.parentNode !== videoViewport ? container.parentNode : context.originalParent;
    }
    if (!context.originalParent) return;
    if (!context.placeholder) {
      context.placeholder = document.createComment('custom-fullscreen-placeholder');
    }
    if (!context.placeholder.parentNode) {
      if (container.parentNode === context.originalParent) {
        context.originalParent.insertBefore(context.placeholder, container);
      } else {
        context.originalParent.appendChild(context.placeholder);
      }
    }
  }

  function moveContainerIntoViewport(container) {
    if (container.parentNode !== videoViewport) {
      while (videoViewport.firstChild) {
        videoViewport.removeChild(videoViewport.firstChild);
      }
      videoViewport.appendChild(container);
    }
  }

  function enterCustomFullscreenFor(container) {
    if (!container) return;
    const context = ensureContext(container);
    if (activeContext && activeContext.container !== container) {
      exitCustomFullscreen();
    }
    ensurePlaceholder(context);
    const hasSidebarContent = populateSidebar(context.sidebarData || {});
    overlay.classList.toggle('is-sidebar-hidden', !hasSidebarContent);
    moveContainerIntoViewport(container);
    overlay.setAttribute('aria-hidden', 'false');
    bodyEl.classList.add('is-custom-fullscreen');
    htmlEl.classList.add('is-custom-fullscreen');
    activeContext = context;
  }

  // 3b. 辅助函数：为 *一个* player 实例绑定 [ ] 按钮事件
  function initializeFullscreenEvents(container) {
    const context = fullscreenContexts.get(container);
    if (!context || !context.player) return;

    const player = context.player;
    const handleFullscreenChange = (data) => {
      if (data && data.fullscreen) {
        console.log("Vimeo: [ ] 按钮被点击。");
        const openCustomFullscreen = () => enterCustomFullscreenFor(container);
        if (typeof player.exitFullscreen === 'function') {
          player.exitFullscreen().catch(() => {}).then(openCustomFullscreen);
        } else {
          openCustomFullscreen();
        }
      }
    };
    player.off('fullscreenchange');
    player.on('fullscreenchange', handleFullscreenChange);
  }

  // 3c. [已修复] 关闭函数：销毁并重建 iframe
  async function exitCustomFullscreen() {
    if (!activeContext) return;

    const { container, placeholder, originalParent, originalSrc } = activeContext;
    const contextToRebuild = activeContext; // 保存 context

    overlay.setAttribute('aria-hidden', 'true');
    bodyEl.classList.remove('is-custom-fullscreen');
    htmlEl.classList.remove('is-custom-fullscreen');

    // 1. 先把 container 移回原位
    const targetParent = (placeholder && placeholder.parentNode) || originalParent || container.parentNode;
    if (targetParent) {
      if (placeholder && placeholder.parentNode === targetParent) {
        targetParent.insertBefore(container, placeholder);
      } else {
        targetParent.appendChild(container);
      }
    }
    
    activeContext = null; // 立即重置

    // 2. [核心修复] 销毁旧 player 并重建 iframe
    if (contextToRebuild && contextToRebuild.player) {
      console.log("Vimeo: 正在卸载旧播放器...");

      let resumePlayback = false;
      let resumeTime = null;

      try {
        const paused = await contextToRebuild.player.getPaused();
        resumePlayback = !paused;
      } catch (e) {
        resumePlayback = false;
      }

      try {
        resumeTime = await contextToRebuild.player.getCurrentTime();
      } catch (e) {
        resumeTime = null;
      }

      try {
        // [已修改] 我们不再用 destroy()，而是用 unload()，它更安全
        await contextToRebuild.player.unload();
      } catch (e) {
        console.warn("Vimeo: 卸载播放器时出错 (可能已被移动)", e);
      }

      // 3. [核心修复] 手动重建 iframe 来修复连接
      const vimeoWrapper = container.querySelector('.vimeo-wrapper');
      if (vimeoWrapper) {
        console.log("Vimeo: 正在重建 iframe...");
        vimeoWrapper.innerHTML = ''; // 清空 wrapper
        
        // 重新创建 iframe 元素
        const newIframe = document.createElement('iframe');
        newIframe.className = 'vimeo-iframe';
        newIframe.src = originalSrc; // [关键] 使用保存的 src
        newIframe.allow = 'autoplay; fullscreen; picture-in-picture';
        newIframe.allowFullscreen = true;
        newIframe.title = 'Hokkaido Experience';
        vimeoWrapper.appendChild(newIframe);

        // 4. [核心修复] 为 *新* iframe 创建 *新* player
        console.log("Vimeo: 正在创建新播放器...");
        const newPlayer = new Vimeo.Player(newIframe);
        contextToRebuild.player = newPlayer; // 更新 context 中的 player

        // 5. [核心修复] 重新绑定 *所有* 事件
        console.log("Vimeo: 正在重新绑定所有事件...");
        initializeFullscreenEvents(container); // 重新绑定 [ ] 按钮
        initializeSubtitleEvents(newPlayer); // 重新绑定字幕事件
        console.log("Vimeo: 重建完成。");

        if (typeof resumeTime === 'number') {
          newPlayer.setCurrentTime(resumeTime).catch(() => {});
        }

        if (resumePlayback) {
          newPlayer.play().catch(() => {
            newPlayer.ready().then(() => newPlayer.play()).catch(() => {});
          });
        }
      }
    }

  if (contextToRebuild.sidebarData) {
    restoreSidebarDataset(container, contextToRebuild.sidebarData);
  }

  }

  // 3d. 绑定关闭事件
  closeButton?.addEventListener('click', () => exitCustomFullscreen());
  overlay?.addEventListener('click', (e) => { if (e.target === overlay) exitCustomFullscreen(); });
  wrapper?.addEventListener('click', (e) => e.stopPropagation());
  document.addEventListener('keydown', (e) => { if (e.key === 'Escape') exitCustomFullscreen(); });

  // 3e. 循环所有视频容器，初始化 *所有* 功能
  const containers = document.querySelectorAll('[data-custom-fullscreen]');
  containers.forEach((container) => {
    const context = ensureContext(container); // 创建 context 和 *唯一* 的 player
    if (context && context.player) {
      initializeFullscreenEvents(container); // 绑定 [ ] 按钮
      initializeSubtitleEvents(context.player); // 绑定字幕
      initializeHitboxEvents(container);
    }

    // (根据你的要求，我们忽略了 .vimeo-toggle-hitbox)

    // 保留这些自定义事件
    container.addEventListener('custom-fullscreen:open', () => {
      enterCustomFullscreenFor(container);
    });
    container.addEventListener('custom-fullscreen:close', () => {
      if (activeContext && activeContext.container === container) {
        exitCustomFullscreen();
      }
    });
  });

});
</script>

</body>
</html>